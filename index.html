<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For you ‚ù§Ô∏è</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        :root {
            --pink: #ff4d6d;
            --soft-pink: #ffb3c1;
            --dark: #050505;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background: var(--dark); color: white;
            font-family: 'Georgia', serif; overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        #bg-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -2; background: radial-gradient(circle at center, #1a000a 0%, #000 100%);
        }

        .floating-memories {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; pointer-events: none;
        }

        .drift-photo {
            position: absolute; width: 150px; opacity: 0;
            border-radius: 15px; filter: contrast(1.1) brightness(0.8);
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            transition: opacity 2s;
        }

        .container {
            position: relative; z-index: 10;
            display: flex; flex-direction: column; align-items: center;
            justify-content: center; height: 100%; padding: 30px;
            text-align: center; box-sizing: border-box;
        }

        .screen { display: none; width: 100%; animation: fadeIn 2s ease forwards; }
        .active { display: flex; flex-direction: column; align-items: center; }

        .typing-text {
            font-size: 1.4rem; line-height: 1.8; font-style: italic;
            background: linear-gradient(to right, #fff, var(--soft-pink));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        
        h1 { font-size: 1.8rem; margin-bottom: 15px; color: var(--soft-pink); }
        .screen p { font-size: 1.1rem; line-height: 1.6; color: #f0f0f0; }

        #gate {
            width: 180px; height: 180px; border-radius: 50%;
            border: 3px solid white; background: url('main.jpg') center/cover;
            box-shadow: 0 0 40px var(--pink); cursor: pointer;
            margin-top: 30px; animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 20px var(--pink); }
            50% { transform: scale(1.05); box-shadow: 0 0 50px var(--pink); }
            100% { transform: scale(1); box-shadow: 0 0 20px var(--pink); }
        }

        .choice-img {
            width: 100%; aspect-ratio: 1/1; object-fit: cover;
            border-radius: 10px; border: 2px solid transparent; transition: 0.3s;
        }

        textarea {
            width: 100%; height: 120px; background: rgba(255,255,255,0.1);
            border: 1px solid var(--pink); border-radius: 15px; color: white;
            padding: 15px; font-family: sans-serif; margin: 20px 0; box-sizing: border-box;
        }

        .btn {
            background: white; color: black; border: none;
            padding: 15px 40px; border-radius: 50px; font-weight: bold;
            letter-spacing: 1px; text-transform: uppercase; cursor: pointer;
            margin-top: 15px;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <canvas id="bg-canvas"></canvas>
    <div class="floating-memories" id="photoLayer"></div>
    <audio id="song" src="song.mp3" loop></audio>

    <div class="container">
        <div class="screen active" id="s1">
            <p class="typing-text">
                Today, the universe decided to be beautiful...<br>
                Happy Birthday to the one who makes the stars look dim.<br>
                To the most important person in my world.
            </p>
            <div id="gate" onclick="openGate()"></div>
            <p style="margin-top: 20px; font-size: 0.8rem; letter-spacing: 2px; opacity: 0.6;">TAP THE CENTER</p>
        </div>

        <div class="screen" id="s2">
            <h1>The Day You Were Born üåç</h1>
            <p>The sky over <b>Delhi</b> was just another sky. The world was busy. News. Songs. Noise. But something quietly extraordinary happened that day. You entered the timeline.</p>
            <button class="btn" onclick="nextScreen(3)">Next</button>
        </div>

        <div class="screen" id="s3">
            <h1>Who You Became ‚ú®</h1>
            <p>You grew into someone who feels deeply, cares endlessly, and carries a softness that this world doesn‚Äôt deserve. You call it weakness. It's actually your superpower.</p>
            <button class="btn" onclick="nextScreen(4)">Next</button>
        </div>

        <div class="screen" id="s4">
            <h1>What You Mean To Me üí´</h1>
            <p>You are calm in chaos. Light in overthinking nights. A presence that makes everything feel less heavy. You didn‚Äôt enter my life ‚Äî you changed its atmosphere.</p>
            <button class="btn" onclick="nextScreen(5)">Next</button>
        </div>

        <div class="screen" id="s5">
            <h1 style="text-shadow: 0 0 10px var(--pink);">The Truth ‚ù§Ô∏è</h1>
            <p>The most important thing that happened the day you were born wasn‚Äôt in the news. It was you. And in all timelines, I‚Äôm grateful mine crossed yours.</p>
            <button class="btn" onclick="nextScreen(6)">Continue</button>
        </div>

        <div class="screen" id="s6">
            <h2 style="font-weight: lighter; margin-bottom: 10px;">Memories in Motion...</h2>
            <p style="font-size: 0.9rem; opacity: 0.8;">Tap each photo to see the magic</p>
            <div id="memory-container" style="position: relative; width: 280px; height: 350px; margin: 20px auto;"></div>
            <div id="poetic-line" style="min-height: 60px; margin-top: 15px; font-style: italic; color: var(--soft-pink); font-size: 1.1rem; padding: 0 10px;">
                Click the stack to begin...
            </div>
            <button class="btn" id="nextBtn" onclick="nextScreen(7)" style="display:none; margin-top: 20px;">That's all of them ‚ù§Ô∏è</button>
        </div>

        <div class="screen" id="s7">
            <h2 style="font-weight: lighter;">One last thing...</h2>
            <p>How are you feeling in this very second? I want to save this memory.</p>
            <textarea id="userMsg" placeholder="Write to me..."></textarea>
            <button class="btn" onclick="saveResponse()">Send My Heart</button>
        </div>

        <div class="screen" id="s8">
            <h1 style="color: var(--pink);">Message Saved.</h1>
            <p>I hope this brought a smile to your beautiful face today.</p>
            <div style="font-size: 2rem; margin-top: 20px;">‚ù§Ô∏è</div>
        </div>
    </div>

    <script>
        (function() {
            emailjs.init("5W5A5iIpAjJ2OzR6a"); 
        })();

        const song = document.getElementById('song');

        const captions = [
            "A glimpse of perfection.", "The way the light finds you.", "My favorite version of reality.",
            "A smile that resets my world.", "Captured magic.", "Pure, unedited grace.",
            "The reason I believe in beauty.", "Simply breathtaking.", "A moment frozen in love.",
            "Your eyes tell a thousand stories.", "The highlight of my gallery.", "Every pixel screams elegance.",
            "Soulful and serene.", "My heart in a frame.", "The definition of radiant.",
            "Wild and wonderful.", "A masterpiece in human form.", "My favorite view, forever.",
            "Your glow is unmatched.", "The best thing I've ever seen."
        ];
        let currentPhotoIdx = 0;

        function openGate() {
            song.play().catch(() => console.log("Music blocked"));
            setupCollage();
            const gate = document.getElementById('gate');
            gate.style.transform = 'scale(5)';
            gate.style.opacity = '0';
            setTimeout(() => { nextScreen(2); }, 800);
        }

        function nextScreen(num) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('s' + num).classList.add('active');
            // Song logic removed from here so it plays continuously once started
        }

        function setupCollage() {
            const container = document.getElementById('memory-container');
            for (let i = 20; i >= 1; i--) {
                const img = document.createElement('img');
                img.src = `photo${i}.jpg`;
                img.className = 'choice-img';
                img.style.position = 'absolute';
                img.style.top = '0';
                img.style.left = '0';
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.zIndex = 21 - i;
                img.style.transform = `rotate(${Math.random() * 10 - 5}deg)`;
                img.style.transition = 'all 0.6s cubic-bezier(0.23, 1, 0.32, 1)';
                
                img.onclick = function() {
                    if (this.style.opacity !== '0') {
                        revealNext(this);
                    }
                };
                container.appendChild(img);
            }
        }

        function revealNext(el) {
            el.style.transform = `translate(200%, -50%) rotate(45deg)`;
            el.style.opacity = '0';
            el.style.pointerEvents = 'none';

            const textDisplay = document.getElementById('poetic-line');
            textDisplay.style.opacity = '0';
            
            setTimeout(() => {
                textDisplay.innerText = captions[currentPhotoIdx] || "Every memory with you is a gift.";
                textDisplay.style.opacity = '1';
                currentPhotoIdx++;
                if(currentPhotoIdx >= 20) {
                    document.getElementById('nextBtn').style.display = 'inline-block';
                }
            }, 300);
        }

        function saveResponse() {
            const msg = document.getElementById('userMsg').value;
            if(!msg) return alert("Please share your feelings! ‚ù§Ô∏è");
            const btn = document.querySelector('#s7 .btn');
            btn.innerHTML = "Sending...";
            btn.disabled = true;

            const params = { 
                fav_photo: "All Photos Viewed", 
                message: msg,
                sent_at: new Date().toLocaleString()
            };

            emailjs.send("service_4cv9z5e", "template_i5zkhfl", params)
                .then(() => { nextScreen(8); })
                .catch((err) => {
                    nextScreen(8); 
                });
        }

        // --- Photo-Heart Canvas Background ---
        const canvas = document.getElementById('bg-canvas');
        const ctx = canvas.getContext('2d');
        let hearts = [];
        const heartImages = [];

        // Load images for the hearts
        for(let i=1; i<=20; i++) {
            const img = new Image();
            img.src = `photo${i}.jpg`;
            heartImages.push(img);
        }

        function initHearts() {
            canvas.width = window.innerWidth; 
            canvas.height = window.innerHeight;
            hearts = [];
            for(let i=0; i<15; i++) {
                hearts.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: 40 + Math.random() * 60,
                    speed: 0.5 + Math.random() * 1,
                    img: heartImages[i % heartImages.length],
                    angle: Math.random() * Math.PI * 2
                });
            }
        }

        function drawHeartImage(ctx, x, y, size, img) {
            ctx.save();
            ctx.translate(x, y);
            // Create heart clipping path
            ctx.beginPath();
            ctx.moveTo(0, size / 4);
            ctx.bezierCurveTo(0, 0, -size / 2, 0, -size / 2, size / 4);
            ctx.bezierCurveTo(-size / 2, size / 2, 0, size * 0.75, 0, size);
            ctx.bezierCurveTo(0, size * 0.75, size / 2, size / 2, size / 2, size / 4);
            ctx.bezierCurveTo(size / 2, 0, 0, 0, 0, size / 4);
            ctx.closePath();
            ctx.clip();
            // Draw image inside heart
            if (img.complete) {
                ctx.drawImage(img, -size/2, 0, size, size);
            }
            ctx.restore();
            // Draw heart border
            ctx.strokeStyle = "rgba(255, 77, 109, 0.5)";
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        function animate() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            hearts.forEach(h => {
                h.y -= h.speed;
                h.x += Math.sin(Date.now() * 0.001 + h.angle) * 0.5;
                if(h.y + h.size < 0) h.y = canvas.height + h.size;
                drawHeartImage(ctx, h.x, h.y, h.size, h.img);
            });
            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', initHearts);
        initHearts();
        animate();
    </script>
</body>
</html>